import{_ as ke}from"./vendor.@babel-98964cd2.js";import{r as _}from"./vendor.react-95be5020.js";import{L as be,a as Et,R as Ct,U as xt,s as Ze,B as St,M as Ot,C as jt,b as Tt,O as Re,P as Ae,S as We,c as we,W as kt,d as Rt,e as At,f as Dt,V as Ft,g as It,N as Lt,A as zt,h as Y,i as Ht,j as Wt,T as $t,D as Nt,k as De,l as qt}from"./vendor.three-019387e0.js";import{u as Bt}from"./vendor.react-use-measure-7425ec55.js";import{F as Vt,u as Ut}from"./vendor.its-fine-ee4311f4.js";import{R as Gt,c as oe}from"./vendor.react-reconciler-e28977e2.js";import{c as Xt}from"./vendor.react-dom-f10f3df1.js";import{s as Yt}from"./vendor.suspend-react-be9769fb.js";import{c as Zt}from"./vendor.zustand-8955c5a6.js";function Nn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ke={exports:{}},Je={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(g,E){var P=g.length;g.push(E);e:for(;0<P;){var O=P-1>>>1,S=g[O];if(0<s(S,E))g[O]=E,g[P]=S,P=O;else break e}}function n(g){return g.length===0?null:g[0]}function i(g){if(g.length===0)return null;var E=g[0],P=g.pop();if(P!==E){g[0]=P;e:for(var O=0,S=g.length,W=S>>>1;O<W;){var A=2*(O+1)-1,V=g[A],N=A+1,Q=g[N];if(0>s(V,P))N<S&&0>s(Q,V)?(g[O]=Q,g[N]=P,O=N):(g[O]=V,g[A]=P,O=A);else if(N<S&&0>s(Q,P))g[O]=Q,g[N]=P,O=N;else break e}}return E}function s(g,E){var P=g.sortIndex-E.sortIndex;return P!==0?P:g.id-E.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var w=Date,m=w.now();e.unstable_now=function(){return w.now()-m}}var a=[],v=[],r=1,o=null,u=3,d=!1,p=!1,M=!1,h=typeof setTimeout=="function"?setTimeout:null,l=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(g){for(var E=n(v);E!==null;){if(E.callback===null)i(v);else if(E.startTime<=g)i(v),E.sortIndex=E.expirationTime,t(a,E);else break;E=n(v)}}function x(g){if(M=!1,y(g),!p)if(n(a)!==null)p=!0,B(j);else{var E=n(v);E!==null&&I(x,E.startTime-g)}}function j(g,E){p=!1,M&&(M=!1,l(F),F=-1),d=!0;var P=u;try{for(y(E),o=n(a);o!==null&&(!(o.expirationTime>E)||g&&!b());){var O=o.callback;if(typeof O=="function"){o.callback=null,u=o.priorityLevel;var S=O(o.expirationTime<=E);E=e.unstable_now(),typeof S=="function"?o.callback=S:o===n(a)&&i(a),y(E)}else i(a);o=n(a)}if(o!==null)var W=!0;else{var A=n(v);A!==null&&I(x,A.startTime-E),W=!1}return W}finally{o=null,u=P,d=!1}}var C=!1,D=null,F=-1,T=5,R=-1;function b(){return!(e.unstable_now()-R<T)}function k(){if(D!==null){var g=e.unstable_now();R=g;var E=!0;try{E=D(!0,g)}finally{E?$():(C=!1,D=null)}}else C=!1}var $;if(typeof f=="function")$=function(){f(k)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,H=U.port2;U.port1.onmessage=k,$=function(){H.postMessage(null)}}else $=function(){h(k,0)};function B(g){D=g,C||(C=!0,$())}function I(g,E){F=h(function(){g(e.unstable_now())},E)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(g){g.callback=null},e.unstable_continueExecution=function(){p||d||(p=!0,B(j))},e.unstable_forceFrameRate=function(g){0>g||125<g?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<g?Math.floor(1e3/g):5},e.unstable_getCurrentPriorityLevel=function(){return u},e.unstable_getFirstCallbackNode=function(){return n(a)},e.unstable_next=function(g){switch(u){case 1:case 2:case 3:var E=3;break;default:E=u}var P=u;u=E;try{return g()}finally{u=P}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(g,E){switch(g){case 1:case 2:case 3:case 4:case 5:break;default:g=3}var P=u;u=g;try{return E()}finally{u=P}},e.unstable_scheduleCallback=function(g,E,P){var O=e.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?O+P:O):P=O,g){case 1:var S=-1;break;case 2:S=250;break;case 5:S=1073741823;break;case 4:S=1e4;break;default:S=5e3}return S=P+S,g={id:r++,callback:E,priorityLevel:g,startTime:P,expirationTime:S,sortIndex:-1},P>O?(g.sortIndex=P,t(v,g),n(a)===null&&g===n(v)&&(M?(l(F),F=-1):M=!0,I(x,P-O))):(g.sortIndex=S,t(a,g),p||d||(p=!0,B(j))),g},e.unstable_shouldYield=b,e.unstable_wrapCallback=function(g){var E=u;return function(){var P=u;u=E;try{return g.apply(this,arguments)}finally{u=P}}}})(Je);Ke.exports=Je;var $e=Ke.exports;function Qe(e,t,n=(i,s)=>i===s){if(e===t)return!0;if(!e||!t)return!1;const i=e.length;if(t.length!==i)return!1;for(let s=0;s<i;s++)if(!n(e[s],t[s]))return!1;return!0}const X=[];function et(e,t,n=!1,i={}){for(const c of X)if(Qe(t,c.keys,c.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(c,"error"))throw c.error;if(Object.prototype.hasOwnProperty.call(c,"response"))return c.response;if(!n)throw c.promise}const s={keys:t,equal:i.equal,promise:e(...t).then(c=>s.response=c).then(()=>{i.lifespan&&i.lifespan>0&&setTimeout(()=>{const c=X.indexOf(s);c!==-1&&X.splice(c,1)},i.lifespan)}).catch(c=>s.error=c)};if(X.push(s),!n)throw s.promise}const Kt=(e,t,n)=>et(e,t,!1,n),Jt=(e,t,n)=>void et(e,t,!0,n),Qt=e=>{if(e===void 0||e.length===0)X.splice(0,X.length);else{const t=X.find(n=>Qe(e,n.keys,n.equal));if(t){const n=X.indexOf(t);n!==-1&&X.splice(n,1)}}},Fe={},en=e=>void Object.assign(Fe,e);function tn(e,t){function n(r,{args:o=[],attach:u,...d},p){let M=`${r[0].toUpperCase()}${r.slice(1)}`,h;if(r==="primitive"){if(d.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const l=d.object;h=ne(l,{type:r,root:p,attach:u,primitive:!0})}else{const l=Fe[M];if(!l)throw new Error(`R3F: ${M} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(o))throw new Error("R3F: The args prop must be an array!");h=ne(new l(...o),{type:r,root:p,attach:u,memoizedProps:{args:o}})}return h.__r3f.attach===void 0&&(h instanceof St?h.__r3f.attach="geometry":h instanceof Ot&&(h.__r3f.attach="material")),M!=="inject"&&Pe(h,d),h}function i(r,o){let u=!1;if(o){var d,p;(d=o.__r3f)!=null&&d.attach?_e(r,o,o.__r3f.attach):o.isObject3D&&r.isObject3D&&(r.add(o),u=!0),u||(p=r.__r3f)==null||p.objects.push(o),o.__r3f||ne(o,{}),o.__r3f.parent=r,je(o),re(o)}}function s(r,o,u){let d=!1;if(o){var p,M;if((p=o.__r3f)!=null&&p.attach)_e(r,o,o.__r3f.attach);else if(o.isObject3D&&r.isObject3D){o.parent=r,o.dispatchEvent({type:"added"});const h=r.children.filter(f=>f!==o),l=h.indexOf(u);r.children=[...h.slice(0,l),o,...h.slice(l)],d=!0}d||(M=r.__r3f)==null||M.objects.push(o),o.__r3f||ne(o,{}),o.__r3f.parent=r,je(o),re(o)}}function c(r,o,u=!1){r&&[...r].forEach(d=>w(o,d,u))}function w(r,o,u){if(o){var d,p,M;if(o.__r3f&&(o.__r3f.parent=null),(d=r.__r3f)!=null&&d.objects&&(r.__r3f.objects=r.__r3f.objects.filter(x=>x!==o)),(p=o.__r3f)!=null&&p.attach)Ue(r,o,o.__r3f.attach);else if(o.isObject3D&&r.isObject3D){var h;r.remove(o),(h=o.__r3f)!=null&&h.root&&un(o.__r3f.root,o)}const f=(M=o.__r3f)==null?void 0:M.primitive,y=u===void 0?o.dispose!==null&&!f:u;if(!f){var l;c((l=o.__r3f)==null?void 0:l.objects,o,y),c(o.children,o,y)}o.__r3f&&(delete o.__r3f.root,delete o.__r3f.objects,delete o.__r3f.handlers,delete o.__r3f.memoizedProps,f||delete o.__r3f),y&&o.dispose&&o.type!=="Scene"&&$e.unstable_scheduleCallback($e.unstable_IdlePriority,()=>{try{o.dispose()}catch{}}),re(r)}}function m(r,o,u,d){var p;const M=(p=r.__r3f)==null?void 0:p.parent;if(!M)return;const h=n(o,u,r.__r3f.root);if(r.children){for(const l of r.children)l.__r3f&&i(h,l);r.children=r.children.filter(l=>!l.__r3f)}r.__r3f.objects.forEach(l=>i(h,l)),r.__r3f.objects=[],r.__r3f.autoRemovedBeforeAppend||w(M,r),h.parent&&(h.__r3f.autoRemovedBeforeAppend=!0),i(M,h),h.raycast&&h.__r3f.eventCount&&h.__r3f.root.getState().internal.interaction.push(h),[d,d.alternate].forEach(l=>{l!==null&&(l.stateNode=h,l.ref&&(typeof l.ref=="function"?l.ref(h):l.ref.current=h))})}const a=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:Gt({createInstance:n,removeChild:w,appendChild:i,appendInitialChild:i,insertBefore:s,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(r,o)=>{if(!o)return;const u=r.getState().scene;u.__r3f&&(u.__r3f.root=r,i(u,o))},removeChildFromContainer:(r,o)=>{o&&w(r.getState().scene,o)},insertInContainerBefore:(r,o,u)=>{if(!o||!u)return;const d=r.getState().scene;d.__r3f&&s(d,o,u)},getRootHostContext:()=>null,getChildHostContext:r=>r,finalizeInitialChildren(r){var o;return!!((o=r==null?void 0:r.__r3f)!=null?o:{}).handlers},prepareUpdate(r,o,u,d){if(r.__r3f.primitive&&d.object&&d.object!==r)return[!0];{const{args:p=[],children:M,...h}=d,{args:l=[],children:f,...y}=u;if(!Array.isArray(p))throw new Error("R3F: the args prop must be an array!");if(p.some((j,C)=>j!==l[C]))return[!0];const x=at(r,h,y,!0);return x.changes.length?[!1,x]:null}},commitUpdate(r,[o,u],d,p,M,h){o?m(r,d,M,h):Pe(r,u)},commitMount(r,o,u,d){var p;const M=(p=r.__r3f)!=null?p:{};r.raycast&&M.handlers&&M.eventCount&&r.__r3f.root.getState().internal.interaction.push(r)},getPublicInstance:r=>r,prepareForCommit:()=>null,preparePortalMount:r=>ne(r.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(r){var o;const{attach:u,parent:d}=(o=r.__r3f)!=null?o:{};u&&d&&Ue(d,r,u),r.isObject3D&&(r.visible=!1),re(r)},unhideInstance(r,o){var u;const{attach:d,parent:p}=(u=r.__r3f)!=null?u:{};d&&p&&_e(p,r,d),(r.isObject3D&&o.visible==null||o.visible)&&(r.visible=!0),re(r)},createTextInstance:a,hideTextInstance:a,unhideTextInstance:a,getCurrentEventPriority:()=>t?t():oe.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&z.fun(performance.now)?performance.now:z.fun(Date.now)?Date.now:()=>0,scheduleTimeout:z.fun(setTimeout)?setTimeout:void 0,cancelTimeout:z.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Pe}}var Ne,qe;const tt=()=>{var e;return(e=Fe.ColorManagement)!=null?e:null},nt=e=>e&&e.isOrthographicCamera,nn=e=>e&&e.hasOwnProperty("current"),ue=typeof window<"u"&&((Ne=window.document)!=null&&Ne.createElement||((qe=window.navigator)==null?void 0:qe.product)==="ReactNative")?_.useLayoutEffect:_.useEffect;function rt(e){const t=_.useRef(e);return ue(()=>void(t.current=e),[e]),t}function rn({set:e}){return ue(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class ot extends _.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}}ot.getDerivedStateFromError=()=>({error:!0});const it="__default",Be=new Map,on=e=>e&&!!e.memoized&&!!e.changes;function st(e){const t=typeof window<"u"?window.devicePixelRatio:1;return Array.isArray(e)?Math.min(Math.max(e[0],t),e[1]):e}const ae=e=>{var t;return(t=e.__r3f)==null?void 0:t.root.getState()},z={obj:e=>e===Object(e)&&!z.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,arr:e=>Array.isArray(e),equ(e,t,{arrays:n="shallow",objects:i="reference",strict:s=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(z.str(e)||z.num(e))return e===t;const c=z.obj(e);if(c&&i==="reference")return e===t;const w=z.arr(e);if(w&&n==="reference")return e===t;if((w||c)&&e===t)return!0;let m;for(m in e)if(!(m in t))return!1;if(c&&n==="shallow"&&i==="shallow"){for(m in s?t:e)if(!z.equ(e[m],t[m],{strict:s,objects:"reference"}))return!1}else for(m in s?t:e)if(e[m]!==t[m])return!1;if(z.und(m)){if(w&&e.length===0&&t.length===0||c&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function sn(e){const t={nodes:{},materials:{}};return e&&e.traverse(n=>{n.name&&(t.nodes[n.name]=n),n.material&&!t.materials[n.material.name]&&(t.materials[n.material.name]=n.material)}),t}function an(e){e.dispose&&e.type!=="Scene"&&e.dispose();for(const t in e)t.dispose==null||t.dispose(),delete e[t]}function ne(e,t){const n=e;return(t!=null&&t.primitive||!n.__r3f)&&(n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t}),e}function Oe(e,t){let n=e;if(t.includes("-")){const i=t.split("-"),s=i.pop();return n=i.reduce((c,w)=>c[w],e),{target:n,key:s}}else return{target:n,key:t}}const Ve=/-\d+$/;function _e(e,t,n){if(z.str(n)){if(Ve.test(n)){const c=n.replace(Ve,""),{target:w,key:m}=Oe(e,c);Array.isArray(w[m])||(w[m]=[])}const{target:i,key:s}=Oe(e,n);t.__r3f.previousAttach=i[s],i[s]=t}else t.__r3f.previousAttach=n(e,t)}function Ue(e,t,n){var i,s;if(z.str(n)){const{target:c,key:w}=Oe(e,n),m=t.__r3f.previousAttach;m===void 0?delete c[w]:c[w]=m}else(i=t.__r3f)==null||i.previousAttach==null||i.previousAttach(e,t);(s=t.__r3f)==null||delete s.previousAttach}function at(e,{children:t,key:n,ref:i,...s},{children:c,key:w,ref:m,...a}={},v=!1){var r;const o=(r=e==null?void 0:e.__r3f)!=null?r:{},u=Object.entries(s),d=[];if(v){const M=Object.keys(a);for(let h=0;h<M.length;h++)s.hasOwnProperty(M[h])||u.unshift([M[h],it+"remove"])}u.forEach(([M,h])=>{var l;if((l=e.__r3f)!=null&&l.primitive&&M==="object"||z.equ(h,a[M]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(M))return d.push([M,h,!0,[]]);let f=[];M.includes("-")&&(f=M.split("-")),d.push([M,h,!1,f]);for(const y in s){const x=s[y];y.startsWith(`${M}-`)&&d.push([y,x,!1,y.split("-")])}});const p={...s};return o.memoizedProps&&o.memoizedProps.args&&(p.args=o.memoizedProps.args),o.memoizedProps&&o.memoizedProps.attach&&(p.attach=o.memoizedProps.attach),{memoized:p,changes:d}}function Pe(e,t){var n,i,s;const c=(n=e.__r3f)!=null?n:{},w=c.root,m=(i=w==null||w.getState==null?void 0:w.getState())!=null?i:{},{memoized:a,changes:v}=on(t)?t:at(e,t),r=c.eventCount;e.__r3f&&(e.__r3f.memoizedProps=a);for(let u=0;u<v.length;u++){let[d,p,M,h]=v[u],l=e,f=l[d];if(h.length&&(f=h.reduce((y,x)=>y[x],e),!(f&&f.set))){const[y,...x]=h.reverse();l=x.reverse().reduce((j,C)=>j[C],e),d=y}if(p===it+"remove")if(l.constructor){let y=Be.get(l.constructor);y||(y=new l.constructor,Be.set(l.constructor,y)),p=y[d]}else p=0;if(M)p?c.handlers[d]=p:delete c.handlers[d],c.eventCount=Object.keys(c.handlers).length;else if(f&&f.set&&(f.copy||f instanceof be)){if(Array.isArray(p))f.fromArray?f.fromArray(p):f.set(...p);else if(f.copy&&p&&p.constructor&&f.constructor===p.constructor)f.copy(p);else if(p!==void 0){const y=f instanceof jt;!y&&f.setScalar?f.setScalar(p):f instanceof be&&p instanceof be?f.mask=p.mask:f.set(p),!tt()&&!m.linear&&y&&f.convertSRGBToLinear()}}else l[d]=p,!m.linear&&l[d]instanceof Et&&l[d].format===Ct&&l[d].type===xt&&(l[d].encoding=Ze);re(e)}if(c.parent&&m.internal&&e.raycast&&r!==c.eventCount){const u=m.internal.interaction.indexOf(e);u>-1&&m.internal.interaction.splice(u,1),c.eventCount&&m.internal.interaction.push(e)}return!(v.length===1&&v[0][0]==="onUpdate")&&v.length&&(s=e.__r3f)!=null&&s.parent&&je(e),e}function re(e){var t,n;const i=(t=e.__r3f)==null||(n=t.root)==null||n.getState==null?void 0:n.getState();i&&i.internal.frames===0&&i.invalidate()}function je(e){e.onUpdate==null||e.onUpdate(e)}function ln(e,t){e.manual||(nt(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function ve(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function cn(){var e;const t=typeof self<"u"&&self||typeof window<"u"&&window;if(!t)return oe.DefaultEventPriority;switch((e=t.event)==null?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return oe.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return oe.ContinuousEventPriority;default:return oe.DefaultEventPriority}}function lt(e,t,n,i){const s=n.get(t);s&&(n.delete(t),n.size===0&&(e.delete(i),s.target.releasePointerCapture(i)))}function un(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(i=>i!==t),n.initialHits=n.initialHits.filter(i=>i!==t),n.hovered.forEach((i,s)=>{(i.eventObject===t||i.object===t)&&n.hovered.delete(s)}),n.capturedMap.forEach((i,s)=>{lt(n.capturedMap,t,i,s)})}function fn(e){function t(a){const{internal:v}=e.getState(),r=a.offsetX-v.initialClick[0],o=a.offsetY-v.initialClick[1];return Math.round(Math.sqrt(r*r+o*o))}function n(a){return a.filter(v=>["Move","Over","Enter","Out","Leave"].some(r=>{var o;return(o=v.__r3f)==null?void 0:o.handlers["onPointer"+r]}))}function i(a,v){const r=e.getState(),o=new Set,u=[],d=v?v(r.internal.interaction):r.internal.interaction;for(let l=0;l<d.length;l++){const f=ae(d[l]);f&&(f.raycaster.camera=void 0)}r.previousRoot||r.events.compute==null||r.events.compute(a,r);function p(l){const f=ae(l);if(!f||!f.events.enabled||f.raycaster.camera===null)return[];if(f.raycaster.camera===void 0){var y;f.events.compute==null||f.events.compute(a,f,(y=f.previousRoot)==null?void 0:y.getState()),f.raycaster.camera===void 0&&(f.raycaster.camera=null)}return f.raycaster.camera?f.raycaster.intersectObject(l,!0):[]}let M=d.flatMap(p).sort((l,f)=>{const y=ae(l.object),x=ae(f.object);return!y||!x?l.distance-f.distance:x.events.priority-y.events.priority||l.distance-f.distance}).filter(l=>{const f=ve(l);return o.has(f)?!1:(o.add(f),!0)});r.events.filter&&(M=r.events.filter(M,r));for(const l of M){let f=l.object;for(;f;){var h;(h=f.__r3f)!=null&&h.eventCount&&u.push({...l,eventObject:f}),f=f.parent}}if("pointerId"in a&&r.internal.capturedMap.has(a.pointerId))for(let l of r.internal.capturedMap.get(a.pointerId).values())o.has(ve(l.intersection))||u.push(l.intersection);return u}function s(a,v,r,o){const u=e.getState();if(a.length){const d={stopped:!1};for(const p of a){const M=ae(p.object)||u,{raycaster:h,pointer:l,camera:f,internal:y}=M,x=new Y(l.x,l.y,0).unproject(f),j=R=>{var b,k;return(b=(k=y.capturedMap.get(R))==null?void 0:k.has(p.eventObject))!=null?b:!1},C=R=>{const b={intersection:p,target:v.target};y.capturedMap.has(R)?y.capturedMap.get(R).set(p.eventObject,b):y.capturedMap.set(R,new Map([[p.eventObject,b]])),v.target.setPointerCapture(R)},D=R=>{const b=y.capturedMap.get(R);b&&lt(y.capturedMap,p.eventObject,b,R)};let F={};for(let R in v){let b=v[R];typeof b!="function"&&(F[R]=b)}let T={...p,...F,pointer:l,intersections:a,stopped:d.stopped,delta:r,unprojectedPoint:x,ray:h.ray,camera:f,stopPropagation(){const R="pointerId"in v&&y.capturedMap.get(v.pointerId);if((!R||R.has(p.eventObject))&&(T.stopped=d.stopped=!0,y.hovered.size&&Array.from(y.hovered.values()).find(b=>b.eventObject===p.eventObject))){const b=a.slice(0,a.indexOf(p));c([...b,p])}},target:{hasPointerCapture:j,setPointerCapture:C,releasePointerCapture:D},currentTarget:{hasPointerCapture:j,setPointerCapture:C,releasePointerCapture:D},nativeEvent:v};if(o(T),d.stopped===!0)break}}return a}function c(a){const{internal:v}=e.getState();for(const r of v.hovered.values())if(!a.length||!a.find(o=>o.object===r.object&&o.index===r.index&&o.instanceId===r.instanceId)){const u=r.eventObject.__r3f,d=u==null?void 0:u.handlers;if(v.hovered.delete(ve(r)),u!=null&&u.eventCount){const p={...r,intersections:a};d.onPointerOut==null||d.onPointerOut(p),d.onPointerLeave==null||d.onPointerLeave(p)}}}function w(a,v){for(let r=0;r<v.length;r++){const o=v[r].__r3f;o==null||o.handlers.onPointerMissed==null||o.handlers.onPointerMissed(a)}}function m(a){switch(a){case"onPointerLeave":case"onPointerCancel":return()=>c([]);case"onLostPointerCapture":return v=>{const{internal:r}=e.getState();"pointerId"in v&&r.capturedMap.has(v.pointerId)&&requestAnimationFrame(()=>{r.capturedMap.has(v.pointerId)&&(r.capturedMap.delete(v.pointerId),c([]))})}}return function(r){const{onPointerMissed:o,internal:u}=e.getState();u.lastEvent.current=r;const d=a==="onPointerMove",p=a==="onClick"||a==="onContextMenu"||a==="onDoubleClick",h=i(r,d?n:void 0),l=p?t(r):0;a==="onPointerDown"&&(u.initialClick=[r.offsetX,r.offsetY],u.initialHits=h.map(y=>y.eventObject)),p&&!h.length&&l<=2&&(w(r,u.interaction),o&&o(r)),d&&c(h);function f(y){const x=y.eventObject,j=x.__r3f,C=j==null?void 0:j.handlers;if(j!=null&&j.eventCount)if(d){if(C.onPointerOver||C.onPointerEnter||C.onPointerOut||C.onPointerLeave){const D=ve(y),F=u.hovered.get(D);F?F.stopped&&y.stopPropagation():(u.hovered.set(D,y),C.onPointerOver==null||C.onPointerOver(y),C.onPointerEnter==null||C.onPointerEnter(y))}C.onPointerMove==null||C.onPointerMove(y)}else{const D=C[a];D?(!p||u.initialHits.includes(x))&&(w(r,u.interaction.filter(F=>!u.initialHits.includes(F))),D(y)):p&&u.initialHits.includes(x)&&w(r,u.interaction.filter(F=>!u.initialHits.includes(F)))}}s(h,r,l,f)}}return{handlePointer:m}}const ct=e=>!!(e!=null&&e.render),ut=_.createContext(null),dn=(e,t)=>{const n=Zt((m,a)=>{const v=new Y,r=new Y,o=new Y;function u(l=a().camera,f=r,y=a().size){const{width:x,height:j,top:C,left:D}=y,F=x/j;f instanceof Y?o.copy(f):o.set(...f);const T=l.getWorldPosition(v).distanceTo(o);if(nt(l))return{width:x/l.zoom,height:j/l.zoom,top:C,left:D,factor:1,distance:T,aspect:F};{const R=l.fov*Math.PI/180,b=2*Math.tan(R/2)*T,k=b*(x/j);return{width:k,height:b,top:C,left:D,factor:x/k,distance:T,aspect:F}}}let d;const p=l=>m(f=>({performance:{...f.performance,current:l}})),M=new Ht;return{set:m,get:a,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(l=1)=>e(a(),l),advance:(l,f)=>t(l,f,a()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Wt,pointer:M,mouse:M,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const l=a();d&&clearTimeout(d),l.performance.current!==l.performance.min&&p(l.performance.min),d=setTimeout(()=>p(a().performance.max),l.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:u},setEvents:l=>m(f=>({...f,events:{...f.events,...l}})),setSize:(l,f,y,x,j)=>{const C=a().camera,D={width:l,height:f,top:x||0,left:j||0,updateStyle:y};m(F=>({size:D,viewport:{...F.viewport,...u(C,r,D)}}))},setDpr:l=>m(f=>{const y=st(l);return{viewport:{...f.viewport,dpr:y,initialDpr:f.viewport.initialDpr||y}}}),setFrameloop:(l="always")=>{const f=a().clock;f.stop(),f.elapsedTime=0,l!=="never"&&(f.start(),f.elapsedTime=0),m(()=>({frameloop:l}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:_.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(l,f,y)=>{const x=a().internal;return x.priority=x.priority+(f>0?1:0),x.subscribers.push({ref:l,priority:f,store:y}),x.subscribers=x.subscribers.sort((j,C)=>j.priority-C.priority),()=>{const j=a().internal;j!=null&&j.subscribers&&(j.priority=j.priority-(f>0?1:0),j.subscribers=j.subscribers.filter(C=>C.ref!==l))}}}}}),i=n.getState();let s=i.size,c=i.viewport.dpr,w=i.camera;return n.subscribe(()=>{const{camera:m,size:a,viewport:v,gl:r,set:o}=n.getState();if(a!==s||v.dpr!==c){var u;s=a,c=v.dpr,ln(m,a),r.setPixelRatio(v.dpr);const d=(u=a.updateStyle)!=null?u:typeof HTMLCanvasElement<"u"&&r.domElement instanceof HTMLCanvasElement;r.setSize(a.width,a.height,d)}m!==w&&(w=m,o(d=>({viewport:{...d.viewport,...d.viewport.getCurrentViewport(m)}})))}),n.subscribe(m=>e(m)),n};function pn(e,t){const n={callback:e};return t.add(n),()=>void t.delete(n)}let me,ft=new Set,vn=new Set,mn=new Set;const qn=e=>pn(e,ft);function Me(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function le(e,t){switch(e){case"before":return Me(ft,t);case"after":return Me(vn,t);case"tail":return Me(mn,t)}}let Ee,Ce;function xe(e,t,n){let i=t.clock.getDelta();for(t.frameloop==="never"&&typeof e=="number"&&(i=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),Ee=t.internal.subscribers,me=0;me<Ee.length;me++)Ce=Ee[me],Ce.ref.current(Ce.store.getState(),i,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}function hn(e){let t=!1,n,i,s;function c(a){i=requestAnimationFrame(c),t=!0,n=0,le("before",a);for(const r of e.values()){var v;s=r.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((v=s.gl.xr)!=null&&v.isPresenting)&&(n+=xe(a,s))}if(le("after",a),n===0)return le("tail",a),t=!1,cancelAnimationFrame(i)}function w(a,v=1){var r;if(!a)return e.forEach(o=>w(o.store.getState()),v);(r=a.gl.xr)!=null&&r.isPresenting||!a.internal.active||a.frameloop==="never"||(a.internal.frames=Math.min(60,a.internal.frames+v),t||(t=!0,requestAnimationFrame(c)))}function m(a,v=!0,r,o){if(v&&le("before",a),r)xe(a,r,o);else for(const u of e.values())xe(a,u.store.getState());v&&le("after",a)}return{loop:c,invalidate:w,advance:m}}function dt(){const e=_.useContext(ut);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function ge(e=n=>n,t){return dt()(e,t)}function gn(e,t=0){const n=dt(),i=n.getState().internal.subscribe,s=rt(e);return ue(()=>i(s,t,n),[t,i,n]),null}function pt(e,t){return function(n,...i){const s=new n;return e&&e(s),Promise.all(i.map(c=>new Promise((w,m)=>s.load(c,a=>{a.scene&&Object.assign(a,sn(a.scene)),w(a)},t,a=>m(new Error(`Could not load ${c}: ${a.message})`))))))}}function fe(e,t,n,i){const s=Array.isArray(t)?t:[t],c=Kt(pt(n,i),[e,...s],{equal:z.equ});return Array.isArray(t)?c:c[0]}fe.preload=function(e,t,n){const i=Array.isArray(t)?t:[t];return Jt(pt(n),[e,...i])};fe.clear=function(e,t){const n=Array.isArray(t)?t:[t];return Qt([e,...n])};const ie=new Map,{invalidate:Ge,advance:Xe}=hn(ie),{reconciler:he,applyProps:ce}=tn(ie,cn),te={objects:"shallow",strict:!1},yn=(e,t)=>{const n=typeof e=="function"?e(t):e;return ct(n)?n:new kt({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function bn(e,t){if(t)return t;if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:n,height:i,top:s,left:c}=e.parentElement.getBoundingClientRect();return{width:n,height:i,top:s,left:c}}else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function wn(e){const t=ie.get(e),n=t==null?void 0:t.fiber,i=t==null?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,c=i||dn(Ge,Xe),w=n||he.createContainer(c,oe.ConcurrentRoot,null,!1,null,"",s,null);t||ie.set(e,{fiber:w,store:c});let m,a=!1,v;return{configure(r={}){let{gl:o,size:u,scene:d,events:p,onCreated:M,shadows:h=!1,linear:l=!1,flat:f=!1,legacy:y=!1,orthographic:x=!1,frameloop:j="always",dpr:C=[1,2],performance:D,raycaster:F,camera:T,onPointerMissed:R}=r,b=c.getState(),k=b.gl;b.gl||b.set({gl:k=yn(o,e)});let $=b.raycaster;$||b.set({raycaster:$=new Tt});const{params:U,...H}=F||{};if(z.equ(H,$,te)||ce($,{...H}),z.equ(U,$.params,te)||ce($,{params:{...$.params,...U}}),!b.camera||b.camera===v&&!z.equ(v,T,te)){v=T;const O=T instanceof Rt,S=O?T:x?new Re(0,0,0,0,.1,1e3):new Ae(75,0,.1,1e3);O||(S.position.z=5,T&&ce(S,T),!b.camera&&!(T!=null&&T.rotation)&&S.lookAt(0,0,0)),b.set({camera:S})}if(!b.scene){let O;d instanceof We?O=d:(O=new We,d&&ce(O,d)),b.set({scene:ne(O)})}if(!b.xr){const O=(A,V)=>{const N=c.getState();N.frameloop!=="never"&&Xe(A,!0,N,V)},S=()=>{const A=c.getState();A.gl.xr.enabled=A.gl.xr.isPresenting,A.gl.xr.setAnimationLoop(A.gl.xr.isPresenting?O:null),A.gl.xr.isPresenting||Ge(A)},W={connect(){const A=c.getState().gl;A.xr.addEventListener("sessionstart",S),A.xr.addEventListener("sessionend",S)},disconnect(){const A=c.getState().gl;A.xr.removeEventListener("sessionstart",S),A.xr.removeEventListener("sessionend",S)}};k.xr&&W.connect(),b.set({xr:W})}if(k.shadowMap){const O=k.shadowMap.enabled,S=k.shadowMap.type;if(k.shadowMap.enabled=!!h,z.boo(h))k.shadowMap.type=we;else if(z.str(h)){var B;const W={basic:At,percentage:Dt,soft:we,variance:Ft};k.shadowMap.type=(B=W[h])!=null?B:we}else z.obj(h)&&Object.assign(k.shadowMap,h);(O!==k.shadowMap.enabled||S!==k.shadowMap.type)&&(k.shadowMap.needsUpdate=!0)}const I=tt();I&&("enabled"in I?I.enabled=!y:"legacyMode"in I&&(I.legacyMode=y));const g=l?It:Ze,E=f?Lt:zt;k.outputEncoding!==g&&(k.outputEncoding=g),k.toneMapping!==E&&(k.toneMapping=E),b.legacy!==y&&b.set(()=>({legacy:y})),b.linear!==l&&b.set(()=>({linear:l})),b.flat!==f&&b.set(()=>({flat:f})),o&&!z.fun(o)&&!ct(o)&&!z.equ(o,k,te)&&ce(k,o),p&&!b.events.handlers&&b.set({events:p(c)});const P=bn(e,u);return z.equ(P,b.size,te)||b.setSize(P.width,P.height,P.updateStyle,P.top,P.left),C&&b.viewport.dpr!==st(C)&&b.setDpr(C),b.frameloop!==j&&b.setFrameloop(j),b.onPointerMissed||b.set({onPointerMissed:R}),D&&!z.equ(D,b.performance,te)&&b.set(O=>({performance:{...O.performance,...D}})),m=M,a=!0,this},render(r){return a||this.configure(),he.updateContainer(_.createElement(_n,{store:c,children:r,onCreated:m,rootElement:e}),w,null,()=>{}),c},unmount(){vt(e)}}}function _n({store:e,children:t,onCreated:n,rootElement:i}){return ue(()=>{const s=e.getState();s.set(c=>({internal:{...c.internal,active:!0}})),n&&n(s),e.getState().events.connected||s.events.connect==null||s.events.connect(i)},[]),_.createElement(ut.Provider,{value:e},t)}function vt(e,t){const n=ie.get(e),i=n==null?void 0:n.fiber;if(i){const s=n==null?void 0:n.store.getState();s&&(s.internal.active=!1),he.updateContainer(null,i,null,()=>{s&&setTimeout(()=>{try{var c,w,m,a;s.events.disconnect==null||s.events.disconnect(),(c=s.gl)==null||(w=c.renderLists)==null||w.dispose==null||w.dispose(),(m=s.gl)==null||m.forceContextLoss==null||m.forceContextLoss(),(a=s.gl)!=null&&a.xr&&s.xr.disconnect(),an(s),ie.delete(e),t&&t(e)}catch{}},500)})}}he.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:_.version});const Se={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Pn(e){const{handlePointer:t}=fn(e);return{priority:1,enabled:!0,compute(n,i,s){i.pointer.set(n.offsetX/i.size.width*2-1,-(n.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(Se).reduce((n,i)=>({...n,[i]:t(i)}),{}),update:()=>{var n;const{events:i,internal:s}=e.getState();(n=s.lastEvent)!=null&&n.current&&i.handlers&&i.handlers.onPointerMove(s.lastEvent.current)},connect:n=>{var i;const{set:s,events:c}=e.getState();c.disconnect==null||c.disconnect(),s(w=>({events:{...w.events,connected:n}})),Object.entries((i=c.handlers)!=null?i:[]).forEach(([w,m])=>{const[a,v]=Se[w];n.addEventListener(a,m,{passive:v})})},disconnect:()=>{const{set:n,events:i}=e.getState();if(i.connected){var s;Object.entries((s=i.handlers)!=null?s:[]).forEach(([c,w])=>{if(i&&i.connected instanceof HTMLElement){const[m]=Se[c];i.connected.removeEventListener(m,w)}}),n(c=>({events:{...c.events,connected:void 0}}))}}}}const Mn=_.forwardRef(function({children:t,fallback:n,resize:i,style:s,gl:c,events:w=Pn,eventSource:m,eventPrefix:a,shadows:v,linear:r,flat:o,legacy:u,orthographic:d,frameloop:p,dpr:M,performance:h,raycaster:l,camera:f,onPointerMissed:y,onCreated:x,...j},C){_.useMemo(()=>en($t),[]);const D=Ut(),[F,T]=Bt({scroll:!0,debounce:{scroll:50,resize:0},...i}),R=_.useRef(null),b=_.useRef(null);_.useImperativeHandle(C,()=>R.current);const k=rt(y),[$,U]=_.useState(!1),[H,B]=_.useState(!1);if($)throw $;if(H)throw H;const I=_.useRef(null);ue(()=>{const E=R.current;T.width>0&&T.height>0&&E&&(I.current||(I.current=wn(E)),I.current.configure({gl:c,events:w,shadows:v,linear:r,flat:o,legacy:u,orthographic:d,frameloop:p,dpr:M,performance:h,raycaster:l,camera:f,size:T,onPointerMissed:(...P)=>k.current==null?void 0:k.current(...P),onCreated:P=>{P.events.connect==null||P.events.connect(m?nn(m)?m.current:m:b.current),a&&P.setEvents({compute:(O,S)=>{const W=O[a+"X"],A=O[a+"Y"];S.pointer.set(W/S.size.width*2-1,-(A/S.size.height)*2+1),S.raycaster.setFromCamera(S.pointer,S.camera)}}),x==null||x(P)}}),I.current.render(_.createElement(D,null,_.createElement(ot,{set:B},_.createElement(_.Suspense,{fallback:_.createElement(rn,{set:U})},t)))))}),_.useEffect(()=>{const E=R.current;if(E)return()=>vt(E)},[]);const g=m?"none":"auto";return _.createElement("div",ke({ref:b,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:g,...s}},j),_.createElement("div",{ref:F,style:{width:"100%",height:"100%"}},_.createElement("canvas",{ref:R,style:{display:"block"}},n)))}),Bn=_.forwardRef(function(t,n){return _.createElement(Vt,null,_.createElement(Mn,ke({},t,{ref:n})))}),de=new Y,Ie=new Y,En=new Y;function Cn(e,t,n){const i=de.setFromMatrixPosition(e.matrixWorld);i.project(t);const s=n.width/2,c=n.height/2;return[i.x*s+s,-(i.y*c)+c]}function xn(e,t){const n=de.setFromMatrixPosition(e.matrixWorld),i=Ie.setFromMatrixPosition(t.matrixWorld),s=n.sub(i),c=t.getWorldDirection(En);return s.angleTo(c)>Math.PI/2}function Sn(e,t,n,i){const s=de.setFromMatrixPosition(e.matrixWorld),c=s.clone();c.project(t),n.setFromCamera(c,t);const w=n.intersectObjects(i,!0);if(w.length){const m=w[0].distance;return s.distanceTo(n.ray.origin)<m}return!0}function On(e,t){if(t instanceof Re)return t.zoom;if(t instanceof Ae){const n=de.setFromMatrixPosition(e.matrixWorld),i=Ie.setFromMatrixPosition(t.matrixWorld),s=t.fov*Math.PI/180,c=n.distanceTo(i);return 1/(2*Math.tan(s/2)*c)}else return 1}function jn(e,t,n){if(t instanceof Ae||t instanceof Re){const i=de.setFromMatrixPosition(e.matrixWorld),s=Ie.setFromMatrixPosition(t.matrixWorld),c=i.distanceTo(s),w=(n[1]-n[0])/(t.far-t.near),m=n[1]-w*t.far;return Math.round(w*c+m)}}const Te=e=>Math.abs(e)<1e-10?0:e;function mt(e,t,n=""){let i="matrix3d(";for(let s=0;s!==16;s++)i+=Te(t[s]*e.elements[s])+(s!==15?",":")");return n+i}const Tn=(e=>t=>mt(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),kn=(e=>(t,n)=>mt(t,e(n),"translate(-50%,-50%)"))(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1]);function Rn(e){return e&&typeof e=="object"&&"current"in e}const Vn=_.forwardRef(({children:e,eps:t=.001,style:n,className:i,prepend:s,center:c,fullscreen:w,portal:m,distanceFactor:a,sprite:v=!1,transform:r=!1,occlude:o,onOcclude:u,castShadow:d,receiveShadow:p,material:M,geometry:h,zIndexRange:l=[16777271,0],calculatePosition:f=Cn,as:y="div",wrapperClass:x,pointerEvents:j="auto",...C},D)=>{const{gl:F,camera:T,scene:R,size:b,raycaster:k,events:$,viewport:U}=ge(),[H]=_.useState(()=>document.createElement(y)),B=_.useRef(),I=_.useRef(null),g=_.useRef(0),E=_.useRef([0,0]),P=_.useRef(null),O=_.useRef(null),S=(m==null?void 0:m.current)||$.connected||F.domElement.parentNode,W=_.useRef(null),A=_.useRef(!1),V=_.useMemo(()=>o&&o!=="blending"||Array.isArray(o)&&o.length&&Rn(o[0]),[o]);_.useLayoutEffect(()=>{const q=F.domElement;o&&o==="blending"?(q.style.zIndex=`${Math.floor(l[0]/2)}`,q.style.position="absolute",q.style.pointerEvents="none"):(q.style.zIndex=null,q.style.position=null,q.style.pointerEvents=null)},[o]),_.useLayoutEffect(()=>{if(I.current){const q=B.current=Xt(H);if(R.updateMatrixWorld(),r)H.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const L=f(I.current,T,b);H.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${L[0]}px,${L[1]}px,0);transform-origin:0 0;`}return S&&(s?S.prepend(H):S.appendChild(H)),()=>{S&&S.removeChild(H),q.unmount()}}},[S,r]),_.useLayoutEffect(()=>{x&&(H.className=x)},[x]);const N=_.useMemo(()=>r?{position:"absolute",top:0,left:0,width:b.width,height:b.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:c?"translate3d(-50%,-50%,0)":"none",...w&&{top:-b.height/2,left:-b.width/2,width:b.width,height:b.height},...n},[n,c,w,b,r]),Q=_.useMemo(()=>({position:"absolute",pointerEvents:j}),[j]);_.useLayoutEffect(()=>{if(A.current=!1,r){var q;(q=B.current)==null||q.render(_.createElement("div",{ref:P,style:N},_.createElement("div",{ref:O,style:Q},_.createElement("div",{ref:D,className:i,style:n,children:e}))))}else{var L;(L=B.current)==null||L.render(_.createElement("div",{ref:D,style:N,className:i,children:e}))}});const ee=_.useRef(!0);gn(q=>{if(I.current){T.updateMatrixWorld(),I.current.updateWorldMatrix(!0,!1);const L=r?E.current:f(I.current,T,b);if(r||Math.abs(g.current-T.zoom)>t||Math.abs(E.current[0]-L[0])>t||Math.abs(E.current[1]-L[1])>t){const Z=xn(I.current,T);let G=!1;V&&(Array.isArray(o)?G=o.map(K=>K.current):o!=="blending"&&(G=[R]));const se=ee.current;if(G){const K=Sn(I.current,T,k,G);ee.current=K&&!Z}else ee.current=!Z;se!==ee.current&&(u?u(!ee.current):H.style.display=ee.current?"block":"none");const pe=Math.floor(l[0]/2),gt=o?V?[l[0],pe]:[pe-1,0]:l;if(H.style.zIndex=`${jn(I.current,T,gt)}`,r){const[K,ze]=[b.width/2,b.height/2],ye=T.projectionMatrix.elements[5]*ze,{isOrthographicCamera:He,top:yt,left:bt,bottom:wt,right:_t}=T,Pt=Tn(T.matrixWorldInverse),Mt=He?`scale(${ye})translate(${Te(-(_t+bt)/2)}px,${Te((yt+wt)/2)}px)`:`translateZ(${ye}px)`;let J=I.current.matrixWorld;v&&(J=T.matrixWorldInverse.clone().transpose().copyPosition(J).scale(I.current.scale),J.elements[3]=J.elements[7]=J.elements[11]=0,J.elements[15]=1),H.style.width=b.width+"px",H.style.height=b.height+"px",H.style.perspective=He?"":`${ye}px`,P.current&&O.current&&(P.current.style.transform=`${Mt}${Pt}translate(${K}px,${ze}px)`,O.current.style.transform=kn(J,1/((a||10)/400)))}else{const K=a===void 0?1:On(I.current,T)*a;H.style.transform=`translate3d(${L[0]}px,${L[1]}px,0) scale(${K})`}E.current=L,g.current=T.zoom}}if(!V&&W.current&&!A.current)if(r){if(P.current){const L=P.current.children[0];if(L!=null&&L.clientWidth&&L!=null&&L.clientHeight){const{isOrthographicCamera:Z}=T;if(Z||h)C.scale&&(Array.isArray(C.scale)?C.scale instanceof Y?W.current.scale.copy(C.scale.clone().divideScalar(1)):W.current.scale.set(1/C.scale[0],1/C.scale[1],1/C.scale[2]):W.current.scale.setScalar(1/C.scale));else{const G=(a||10)/400,se=L.clientWidth*G,pe=L.clientHeight*G;W.current.scale.set(se,pe,1)}A.current=!0}}}else{const L=H.children[0];if(L!=null&&L.clientWidth&&L!=null&&L.clientHeight){const Z=1/U.factor,G=L.clientWidth*Z,se=L.clientHeight*Z;W.current.scale.set(G,se,1),A.current=!0}W.current.lookAt(q.camera.position)}});const Le=_.useMemo(()=>({vertexShader:r?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom" 
            is false. 
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;
            
            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[r]);return _.createElement("group",ke({},C,{ref:I}),o&&!V&&_.createElement("mesh",{castShadow:d,receiveShadow:p,ref:W},h||_.createElement("planeGeometry",null),M||_.createElement("shaderMaterial",{side:Nt,vertexShader:Le.vertexShader,fragmentShader:Le.fragmentShader})))}),Ye=e=>e===Object(e)&&!Array.isArray(e)&&typeof e!="function";function ht(e,t){const n=ge(s=>s.gl),i=fe(De,Ye(e)?Object.values(e):e);if(_.useLayoutEffect(()=>{t==null||t(i)},[t]),_.useEffect(()=>{"initTexture"in n&&(Array.isArray(i)?i:[i]).forEach(n.initTexture)},[n,i]),Ye(e)){const s=Object.keys(e),c={};return s.forEach(w=>Object.assign(c,{[w]:i[s.indexOf(w)]})),c}else return i}ht.preload=e=>fe.preload(De,e);ht.clear=e=>fe.clear(De,e);function Un(e,t){const{unsuspend:n,start:i,crossOrigin:s,muted:c,loop:w,...m}={unsuspend:"loadedmetadata",crossOrigin:"Anonymous",muted:!0,loop:!0,start:!0,playsInline:!0,...t},a=ge(r=>r.gl),v=Yt(()=>new Promise((r,o)=>{const u=Object.assign(document.createElement("video"),{src:typeof e=="string"&&e||void 0,srcObject:e instanceof MediaStream&&e||void 0,crossOrigin:s,loop:w,muted:c,...m}),d=new qt(u);"colorSpace"in d?d.colorSpace=a.outputColorSpace:d.encoding=a.outputEncoding,u.addEventListener(n,()=>r(d))}),[e]);return _.useEffect(()=>void(i&&v.image.play()),[v,i]),v}function Gn(e,t,n=1){const i=ge(w=>w.viewport),s=t*(i.aspect>e/t?i.width/e:i.height/t);return[e*(i.aspect>e/t?i.width/e:i.height/t)*n,s*n,1]}export{Bn as C,Vn as H,qn as a,ce as b,gn as c,ge as d,en as e,Gn as f,Nn as g,Un as h,ht as i,fe as u};
//# sourceMappingURL=vendor.@react-three-2d15087f.js.map
