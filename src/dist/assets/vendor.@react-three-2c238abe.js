import{_ as je}from"./vendor.@babel-98964cd2.js";import{r as P}from"./vendor.react-95be5020.js";import{L as ge,a as wt,R as _t,U as Pt,s as Ve,B as Mt,M as Ct,C as Et,b as St,O as Te,P as ke,S as ze,c as ye,W as xt,d as Ot,e as jt,f as Tt,V as kt,g as Rt,N as At,A as Dt,h as Y,i as Ft,j as It,T as zt,D as Lt}from"./vendor.three-499bb9aa.js";import{u as Ht}from"./vendor.react-use-measure-e2e43e06.js";import{F as Wt,u as $t}from"./vendor.its-fine-ee4311f4.js";import{R as Nt,c as oe}from"./vendor.react-reconciler-1b06a587.js";import{c as qt}from"./vendor.react-dom-f10f3df1.js";import{c as Bt}from"./vendor.zustand-8955c5a6.js";function In(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ge={exports:{}},Xe={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(m,C){var _=m.length;m.push(C);e:for(;0<_;){var O=_-1>>>1,x=m[O];if(0<s(x,C))m[O]=C,m[_]=x,_=O;else break e}}function n(m){return m.length===0?null:m[0]}function i(m){if(m.length===0)return null;var C=m[0],_=m.pop();if(_!==C){m[0]=_;e:for(var O=0,x=m.length,W=x>>>1;O<W;){var A=2*(O+1)-1,U=m[A],N=A+1,Q=m[N];if(0>s(U,_))N<x&&0>s(Q,U)?(m[O]=Q,m[N]=_,O=N):(m[O]=U,m[A]=_,O=A);else if(N<x&&0>s(Q,_))m[O]=Q,m[N]=_,O=N;else break e}}return C}function s(m,C){var _=m.sortIndex-C.sortIndex;return _!==0?_:m.id-C.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var w=Date,h=w.now();e.unstable_now=function(){return w.now()-h}}var a=[],g=[],r=1,o=null,f=3,d=!1,p=!1,M=!1,v=typeof setTimeout=="function"?setTimeout:null,l=typeof clearTimeout=="function"?clearTimeout:null,u=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(m){for(var C=n(g);C!==null;){if(C.callback===null)i(g);else if(C.startTime<=m)i(g),C.sortIndex=C.expirationTime,t(a,C);else break;C=n(g)}}function S(m){if(M=!1,y(m),!p)if(n(a)!==null)p=!0,B(j);else{var C=n(g);C!==null&&I(S,C.startTime-m)}}function j(m,C){p=!1,M&&(M=!1,l(F),F=-1),d=!0;var _=f;try{for(y(C),o=n(a);o!==null&&(!(o.expirationTime>C)||m&&!b());){var O=o.callback;if(typeof O=="function"){o.callback=null,f=o.priorityLevel;var x=O(o.expirationTime<=C);C=e.unstable_now(),typeof x=="function"?o.callback=x:o===n(a)&&i(a),y(C)}else i(a);o=n(a)}if(o!==null)var W=!0;else{var A=n(g);A!==null&&I(S,A.startTime-C),W=!1}return W}finally{o=null,f=_,d=!1}}var E=!1,D=null,F=-1,T=5,R=-1;function b(){return!(e.unstable_now()-R<T)}function k(){if(D!==null){var m=e.unstable_now();R=m;var C=!0;try{C=D(!0,m)}finally{C?$():(E=!1,D=null)}}else E=!1}var $;if(typeof u=="function")$=function(){u(k)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,H=V.port2;V.port1.onmessage=k,$=function(){H.postMessage(null)}}else $=function(){v(k,0)};function B(m){D=m,E||(E=!0,$())}function I(m,C){F=v(function(){m(e.unstable_now())},C)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(m){m.callback=null},e.unstable_continueExecution=function(){p||d||(p=!0,B(j))},e.unstable_forceFrameRate=function(m){0>m||125<m?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<m?Math.floor(1e3/m):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(a)},e.unstable_next=function(m){switch(f){case 1:case 2:case 3:var C=3;break;default:C=f}var _=f;f=C;try{return m()}finally{f=_}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(m,C){switch(m){case 1:case 2:case 3:case 4:case 5:break;default:m=3}var _=f;f=m;try{return C()}finally{f=_}},e.unstable_scheduleCallback=function(m,C,_){var O=e.unstable_now();switch(typeof _=="object"&&_!==null?(_=_.delay,_=typeof _=="number"&&0<_?O+_:O):_=O,m){case 1:var x=-1;break;case 2:x=250;break;case 5:x=1073741823;break;case 4:x=1e4;break;default:x=5e3}return x=_+x,m={id:r++,callback:C,priorityLevel:m,startTime:_,expirationTime:x,sortIndex:-1},_>O?(m.sortIndex=_,t(g,m),n(a)===null&&m===n(g)&&(M?(l(F),F=-1):M=!0,I(S,_-O))):(m.sortIndex=x,t(a,m),p||d||(p=!0,B(j))),m},e.unstable_shouldYield=b,e.unstable_wrapCallback=function(m){var C=f;return function(){var _=f;f=C;try{return m.apply(this,arguments)}finally{f=_}}}})(Xe);Ge.exports=Xe;var Le=Ge.exports;function Ye(e,t,n=(i,s)=>i===s){if(e===t)return!0;if(!e||!t)return!1;const i=e.length;if(t.length!==i)return!1;for(let s=0;s<i;s++)if(!n(e[s],t[s]))return!1;return!0}const X=[];function Ze(e,t,n=!1,i={}){for(const c of X)if(Ye(t,c.keys,c.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(c,"error"))throw c.error;if(Object.prototype.hasOwnProperty.call(c,"response"))return c.response;if(!n)throw c.promise}const s={keys:t,equal:i.equal,promise:e(...t).then(c=>s.response=c).then(()=>{i.lifespan&&i.lifespan>0&&setTimeout(()=>{const c=X.indexOf(s);c!==-1&&X.splice(c,1)},i.lifespan)}).catch(c=>s.error=c)};if(X.push(s),!n)throw s.promise}const Ut=(e,t,n)=>Ze(e,t,!1,n),Vt=(e,t,n)=>void Ze(e,t,!0,n),Gt=e=>{if(e===void 0||e.length===0)X.splice(0,X.length);else{const t=X.find(n=>Ye(e,n.keys,n.equal));if(t){const n=X.indexOf(t);n!==-1&&X.splice(n,1)}}},Re={},Xt=e=>void Object.assign(Re,e);function Yt(e,t){function n(r,{args:o=[],attach:f,...d},p){let M=`${r[0].toUpperCase()}${r.slice(1)}`,v;if(r==="primitive"){if(d.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const l=d.object;v=ne(l,{type:r,root:p,attach:f,primitive:!0})}else{const l=Re[M];if(!l)throw new Error(`R3F: ${M} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(o))throw new Error("R3F: The args prop must be an array!");v=ne(new l(...o),{type:r,root:p,attach:f,memoizedProps:{args:o}})}return v.__r3f.attach===void 0&&(v instanceof Mt?v.__r3f.attach="geometry":v instanceof Ct&&(v.__r3f.attach="material")),M!=="inject"&&we(v,d),v}function i(r,o){let f=!1;if(o){var d,p;(d=o.__r3f)!=null&&d.attach?be(r,o,o.__r3f.attach):o.isObject3D&&r.isObject3D&&(r.add(o),f=!0),f||(p=r.__r3f)==null||p.objects.push(o),o.__r3f||ne(o,{}),o.__r3f.parent=r,xe(o),re(o)}}function s(r,o,f){let d=!1;if(o){var p,M;if((p=o.__r3f)!=null&&p.attach)be(r,o,o.__r3f.attach);else if(o.isObject3D&&r.isObject3D){o.parent=r,o.dispatchEvent({type:"added"});const v=r.children.filter(u=>u!==o),l=v.indexOf(f);r.children=[...v.slice(0,l),o,...v.slice(l)],d=!0}d||(M=r.__r3f)==null||M.objects.push(o),o.__r3f||ne(o,{}),o.__r3f.parent=r,xe(o),re(o)}}function c(r,o,f=!1){r&&[...r].forEach(d=>w(o,d,f))}function w(r,o,f){if(o){var d,p,M;if(o.__r3f&&(o.__r3f.parent=null),(d=r.__r3f)!=null&&d.objects&&(r.__r3f.objects=r.__r3f.objects.filter(S=>S!==o)),(p=o.__r3f)!=null&&p.attach)qe(r,o,o.__r3f.attach);else if(o.isObject3D&&r.isObject3D){var v;r.remove(o),(v=o.__r3f)!=null&&v.root&&rn(o.__r3f.root,o)}const u=(M=o.__r3f)==null?void 0:M.primitive,y=f===void 0?o.dispose!==null&&!u:f;if(!u){var l;c((l=o.__r3f)==null?void 0:l.objects,o,y),c(o.children,o,y)}o.__r3f&&(delete o.__r3f.root,delete o.__r3f.objects,delete o.__r3f.handlers,delete o.__r3f.memoizedProps,u||delete o.__r3f),y&&o.dispose&&o.type!=="Scene"&&Le.unstable_scheduleCallback(Le.unstable_IdlePriority,()=>{try{o.dispose()}catch{}}),re(r)}}function h(r,o,f,d){var p;const M=(p=r.__r3f)==null?void 0:p.parent;if(!M)return;const v=n(o,f,r.__r3f.root);if(r.children){for(const l of r.children)l.__r3f&&i(v,l);r.children=r.children.filter(l=>!l.__r3f)}r.__r3f.objects.forEach(l=>i(v,l)),r.__r3f.objects=[],r.__r3f.autoRemovedBeforeAppend||w(M,r),v.parent&&(v.__r3f.autoRemovedBeforeAppend=!0),i(M,v),v.raycast&&v.__r3f.eventCount&&v.__r3f.root.getState().internal.interaction.push(v),[d,d.alternate].forEach(l=>{l!==null&&(l.stateNode=v,l.ref&&(typeof l.ref=="function"?l.ref(v):l.ref.current=v))})}const a=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:Nt({createInstance:n,removeChild:w,appendChild:i,appendInitialChild:i,insertBefore:s,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(r,o)=>{if(!o)return;const f=r.getState().scene;f.__r3f&&(f.__r3f.root=r,i(f,o))},removeChildFromContainer:(r,o)=>{o&&w(r.getState().scene,o)},insertInContainerBefore:(r,o,f)=>{if(!o||!f)return;const d=r.getState().scene;d.__r3f&&s(d,o,f)},getRootHostContext:()=>null,getChildHostContext:r=>r,finalizeInitialChildren(r){var o;return!!((o=r==null?void 0:r.__r3f)!=null?o:{}).handlers},prepareUpdate(r,o,f,d){if(r.__r3f.primitive&&d.object&&d.object!==r)return[!0];{const{args:p=[],children:M,...v}=d,{args:l=[],children:u,...y}=f;if(!Array.isArray(p))throw new Error("R3F: the args prop must be an array!");if(p.some((j,E)=>j!==l[E]))return[!0];const S=rt(r,v,y,!0);return S.changes.length?[!1,S]:null}},commitUpdate(r,[o,f],d,p,M,v){o?h(r,d,M,v):we(r,f)},commitMount(r,o,f,d){var p;const M=(p=r.__r3f)!=null?p:{};r.raycast&&M.handlers&&M.eventCount&&r.__r3f.root.getState().internal.interaction.push(r)},getPublicInstance:r=>r,prepareForCommit:()=>null,preparePortalMount:r=>ne(r.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(r){var o;const{attach:f,parent:d}=(o=r.__r3f)!=null?o:{};f&&d&&qe(d,r,f),r.isObject3D&&(r.visible=!1),re(r)},unhideInstance(r,o){var f;const{attach:d,parent:p}=(f=r.__r3f)!=null?f:{};d&&p&&be(p,r,d),(r.isObject3D&&o.visible==null||o.visible)&&(r.visible=!0),re(r)},createTextInstance:a,hideTextInstance:a,unhideTextInstance:a,getCurrentEventPriority:()=>t?t():oe.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&L.fun(performance.now)?performance.now:L.fun(Date.now)?Date.now:()=>0,scheduleTimeout:L.fun(setTimeout)?setTimeout:void 0,cancelTimeout:L.fun(clearTimeout)?clearTimeout:void 0}),applyProps:we}}var He,We;const Ke=()=>{var e;return(e=Re.ColorManagement)!=null?e:null},Je=e=>e&&e.isOrthographicCamera,Zt=e=>e&&e.hasOwnProperty("current"),ue=typeof window<"u"&&((He=window.document)!=null&&He.createElement||((We=window.navigator)==null?void 0:We.product)==="ReactNative")?P.useLayoutEffect:P.useEffect;function Qe(e){const t=P.useRef(e);return ue(()=>void(t.current=e),[e]),t}function Kt({set:e}){return ue(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class et extends P.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}}et.getDerivedStateFromError=()=>({error:!0});const tt="__default",$e=new Map,Jt=e=>e&&!!e.memoized&&!!e.changes;function nt(e){const t=typeof window<"u"?window.devicePixelRatio:1;return Array.isArray(e)?Math.min(Math.max(e[0],t),e[1]):e}const ae=e=>{var t;return(t=e.__r3f)==null?void 0:t.root.getState()},L={obj:e=>e===Object(e)&&!L.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,arr:e=>Array.isArray(e),equ(e,t,{arrays:n="shallow",objects:i="reference",strict:s=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(L.str(e)||L.num(e))return e===t;const c=L.obj(e);if(c&&i==="reference")return e===t;const w=L.arr(e);if(w&&n==="reference")return e===t;if((w||c)&&e===t)return!0;let h;for(h in e)if(!(h in t))return!1;if(c&&n==="shallow"&&i==="shallow"){for(h in s?t:e)if(!L.equ(e[h],t[h],{strict:s,objects:"reference"}))return!1}else for(h in s?t:e)if(e[h]!==t[h])return!1;if(L.und(h)){if(w&&e.length===0&&t.length===0||c&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function Qt(e){const t={nodes:{},materials:{}};return e&&e.traverse(n=>{n.name&&(t.nodes[n.name]=n),n.material&&!t.materials[n.material.name]&&(t.materials[n.material.name]=n.material)}),t}function en(e){e.dispose&&e.type!=="Scene"&&e.dispose();for(const t in e)t.dispose==null||t.dispose(),delete e[t]}function ne(e,t){const n=e;return(t!=null&&t.primitive||!n.__r3f)&&(n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t}),e}function Se(e,t){let n=e;if(t.includes("-")){const i=t.split("-"),s=i.pop();return n=i.reduce((c,w)=>c[w],e),{target:n,key:s}}else return{target:n,key:t}}const Ne=/-\d+$/;function be(e,t,n){if(L.str(n)){if(Ne.test(n)){const c=n.replace(Ne,""),{target:w,key:h}=Se(e,c);Array.isArray(w[h])||(w[h]=[])}const{target:i,key:s}=Se(e,n);t.__r3f.previousAttach=i[s],i[s]=t}else t.__r3f.previousAttach=n(e,t)}function qe(e,t,n){var i,s;if(L.str(n)){const{target:c,key:w}=Se(e,n),h=t.__r3f.previousAttach;h===void 0?delete c[w]:c[w]=h}else(i=t.__r3f)==null||i.previousAttach==null||i.previousAttach(e,t);(s=t.__r3f)==null||delete s.previousAttach}function rt(e,{children:t,key:n,ref:i,...s},{children:c,key:w,ref:h,...a}={},g=!1){var r;const o=(r=e==null?void 0:e.__r3f)!=null?r:{},f=Object.entries(s),d=[];if(g){const M=Object.keys(a);for(let v=0;v<M.length;v++)s.hasOwnProperty(M[v])||f.unshift([M[v],tt+"remove"])}f.forEach(([M,v])=>{var l;if((l=e.__r3f)!=null&&l.primitive&&M==="object"||L.equ(v,a[M]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(M))return d.push([M,v,!0,[]]);let u=[];M.includes("-")&&(u=M.split("-")),d.push([M,v,!1,u]);for(const y in s){const S=s[y];y.startsWith(`${M}-`)&&d.push([y,S,!1,y.split("-")])}});const p={...s};return o.memoizedProps&&o.memoizedProps.args&&(p.args=o.memoizedProps.args),o.memoizedProps&&o.memoizedProps.attach&&(p.attach=o.memoizedProps.attach),{memoized:p,changes:d}}function we(e,t){var n,i,s;const c=(n=e.__r3f)!=null?n:{},w=c.root,h=(i=w==null||w.getState==null?void 0:w.getState())!=null?i:{},{memoized:a,changes:g}=Jt(t)?t:rt(e,t),r=c.eventCount;e.__r3f&&(e.__r3f.memoizedProps=a);for(let f=0;f<g.length;f++){let[d,p,M,v]=g[f],l=e,u=l[d];if(v.length&&(u=v.reduce((y,S)=>y[S],e),!(u&&u.set))){const[y,...S]=v.reverse();l=S.reverse().reduce((j,E)=>j[E],e),d=y}if(p===tt+"remove")if(l.constructor){let y=$e.get(l.constructor);y||(y=new l.constructor,$e.set(l.constructor,y)),p=y[d]}else p=0;if(M)p?c.handlers[d]=p:delete c.handlers[d],c.eventCount=Object.keys(c.handlers).length;else if(u&&u.set&&(u.copy||u instanceof ge)){if(Array.isArray(p))u.fromArray?u.fromArray(p):u.set(...p);else if(u.copy&&p&&p.constructor&&u.constructor===p.constructor)u.copy(p);else if(p!==void 0){const y=u instanceof Et;!y&&u.setScalar?u.setScalar(p):u instanceof ge&&p instanceof ge?u.mask=p.mask:u.set(p),!Ke()&&!h.linear&&y&&u.convertSRGBToLinear()}}else l[d]=p,!h.linear&&l[d]instanceof wt&&l[d].format===_t&&l[d].type===Pt&&(l[d].encoding=Ve);re(e)}if(c.parent&&h.internal&&e.raycast&&r!==c.eventCount){const f=h.internal.interaction.indexOf(e);f>-1&&h.internal.interaction.splice(f,1),c.eventCount&&h.internal.interaction.push(e)}return!(g.length===1&&g[0][0]==="onUpdate")&&g.length&&(s=e.__r3f)!=null&&s.parent&&xe(e),e}function re(e){var t,n;const i=(t=e.__r3f)==null||(n=t.root)==null||n.getState==null?void 0:n.getState();i&&i.internal.frames===0&&i.invalidate()}function xe(e){e.onUpdate==null||e.onUpdate(e)}function tn(e,t){e.manual||(Je(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function pe(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function nn(){var e;const t=typeof self<"u"&&self||typeof window<"u"&&window;if(!t)return oe.DefaultEventPriority;switch((e=t.event)==null?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return oe.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return oe.ContinuousEventPriority;default:return oe.DefaultEventPriority}}function ot(e,t,n,i){const s=n.get(t);s&&(n.delete(t),n.size===0&&(e.delete(i),s.target.releasePointerCapture(i)))}function rn(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(i=>i!==t),n.initialHits=n.initialHits.filter(i=>i!==t),n.hovered.forEach((i,s)=>{(i.eventObject===t||i.object===t)&&n.hovered.delete(s)}),n.capturedMap.forEach((i,s)=>{ot(n.capturedMap,t,i,s)})}function on(e){function t(a){const{internal:g}=e.getState(),r=a.offsetX-g.initialClick[0],o=a.offsetY-g.initialClick[1];return Math.round(Math.sqrt(r*r+o*o))}function n(a){return a.filter(g=>["Move","Over","Enter","Out","Leave"].some(r=>{var o;return(o=g.__r3f)==null?void 0:o.handlers["onPointer"+r]}))}function i(a,g){const r=e.getState(),o=new Set,f=[],d=g?g(r.internal.interaction):r.internal.interaction;for(let l=0;l<d.length;l++){const u=ae(d[l]);u&&(u.raycaster.camera=void 0)}r.previousRoot||r.events.compute==null||r.events.compute(a,r);function p(l){const u=ae(l);if(!u||!u.events.enabled||u.raycaster.camera===null)return[];if(u.raycaster.camera===void 0){var y;u.events.compute==null||u.events.compute(a,u,(y=u.previousRoot)==null?void 0:y.getState()),u.raycaster.camera===void 0&&(u.raycaster.camera=null)}return u.raycaster.camera?u.raycaster.intersectObject(l,!0):[]}let M=d.flatMap(p).sort((l,u)=>{const y=ae(l.object),S=ae(u.object);return!y||!S?l.distance-u.distance:S.events.priority-y.events.priority||l.distance-u.distance}).filter(l=>{const u=pe(l);return o.has(u)?!1:(o.add(u),!0)});r.events.filter&&(M=r.events.filter(M,r));for(const l of M){let u=l.object;for(;u;){var v;(v=u.__r3f)!=null&&v.eventCount&&f.push({...l,eventObject:u}),u=u.parent}}if("pointerId"in a&&r.internal.capturedMap.has(a.pointerId))for(let l of r.internal.capturedMap.get(a.pointerId).values())o.has(pe(l.intersection))||f.push(l.intersection);return f}function s(a,g,r,o){const f=e.getState();if(a.length){const d={stopped:!1};for(const p of a){const M=ae(p.object)||f,{raycaster:v,pointer:l,camera:u,internal:y}=M,S=new Y(l.x,l.y,0).unproject(u),j=R=>{var b,k;return(b=(k=y.capturedMap.get(R))==null?void 0:k.has(p.eventObject))!=null?b:!1},E=R=>{const b={intersection:p,target:g.target};y.capturedMap.has(R)?y.capturedMap.get(R).set(p.eventObject,b):y.capturedMap.set(R,new Map([[p.eventObject,b]])),g.target.setPointerCapture(R)},D=R=>{const b=y.capturedMap.get(R);b&&ot(y.capturedMap,p.eventObject,b,R)};let F={};for(let R in g){let b=g[R];typeof b!="function"&&(F[R]=b)}let T={...p,...F,pointer:l,intersections:a,stopped:d.stopped,delta:r,unprojectedPoint:S,ray:v.ray,camera:u,stopPropagation(){const R="pointerId"in g&&y.capturedMap.get(g.pointerId);if((!R||R.has(p.eventObject))&&(T.stopped=d.stopped=!0,y.hovered.size&&Array.from(y.hovered.values()).find(b=>b.eventObject===p.eventObject))){const b=a.slice(0,a.indexOf(p));c([...b,p])}},target:{hasPointerCapture:j,setPointerCapture:E,releasePointerCapture:D},currentTarget:{hasPointerCapture:j,setPointerCapture:E,releasePointerCapture:D},nativeEvent:g};if(o(T),d.stopped===!0)break}}return a}function c(a){const{internal:g}=e.getState();for(const r of g.hovered.values())if(!a.length||!a.find(o=>o.object===r.object&&o.index===r.index&&o.instanceId===r.instanceId)){const f=r.eventObject.__r3f,d=f==null?void 0:f.handlers;if(g.hovered.delete(pe(r)),f!=null&&f.eventCount){const p={...r,intersections:a};d.onPointerOut==null||d.onPointerOut(p),d.onPointerLeave==null||d.onPointerLeave(p)}}}function w(a,g){for(let r=0;r<g.length;r++){const o=g[r].__r3f;o==null||o.handlers.onPointerMissed==null||o.handlers.onPointerMissed(a)}}function h(a){switch(a){case"onPointerLeave":case"onPointerCancel":return()=>c([]);case"onLostPointerCapture":return g=>{const{internal:r}=e.getState();"pointerId"in g&&r.capturedMap.has(g.pointerId)&&requestAnimationFrame(()=>{r.capturedMap.has(g.pointerId)&&(r.capturedMap.delete(g.pointerId),c([]))})}}return function(r){const{onPointerMissed:o,internal:f}=e.getState();f.lastEvent.current=r;const d=a==="onPointerMove",p=a==="onClick"||a==="onContextMenu"||a==="onDoubleClick",v=i(r,d?n:void 0),l=p?t(r):0;a==="onPointerDown"&&(f.initialClick=[r.offsetX,r.offsetY],f.initialHits=v.map(y=>y.eventObject)),p&&!v.length&&l<=2&&(w(r,f.interaction),o&&o(r)),d&&c(v);function u(y){const S=y.eventObject,j=S.__r3f,E=j==null?void 0:j.handlers;if(j!=null&&j.eventCount)if(d){if(E.onPointerOver||E.onPointerEnter||E.onPointerOut||E.onPointerLeave){const D=pe(y),F=f.hovered.get(D);F?F.stopped&&y.stopPropagation():(f.hovered.set(D,y),E.onPointerOver==null||E.onPointerOver(y),E.onPointerEnter==null||E.onPointerEnter(y))}E.onPointerMove==null||E.onPointerMove(y)}else{const D=E[a];D?(!p||f.initialHits.includes(S))&&(w(r,f.interaction.filter(F=>!f.initialHits.includes(F))),D(y)):p&&f.initialHits.includes(S)&&w(r,f.interaction.filter(F=>!f.initialHits.includes(F)))}}s(v,r,l,u)}}return{handlePointer:h}}const it=e=>!!(e!=null&&e.render),st=P.createContext(null),sn=(e,t)=>{const n=Bt((h,a)=>{const g=new Y,r=new Y,o=new Y;function f(l=a().camera,u=r,y=a().size){const{width:S,height:j,top:E,left:D}=y,F=S/j;u instanceof Y?o.copy(u):o.set(...u);const T=l.getWorldPosition(g).distanceTo(o);if(Je(l))return{width:S/l.zoom,height:j/l.zoom,top:E,left:D,factor:1,distance:T,aspect:F};{const R=l.fov*Math.PI/180,b=2*Math.tan(R/2)*T,k=b*(S/j);return{width:k,height:b,top:E,left:D,factor:S/k,distance:T,aspect:F}}}let d;const p=l=>h(u=>({performance:{...u.performance,current:l}})),M=new Ft;return{set:h,get:a,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(l=1)=>e(a(),l),advance:(l,u)=>t(l,u,a()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new It,pointer:M,mouse:M,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const l=a();d&&clearTimeout(d),l.performance.current!==l.performance.min&&p(l.performance.min),d=setTimeout(()=>p(a().performance.max),l.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:f},setEvents:l=>h(u=>({...u,events:{...u.events,...l}})),setSize:(l,u,y,S,j)=>{const E=a().camera,D={width:l,height:u,top:S||0,left:j||0,updateStyle:y};h(F=>({size:D,viewport:{...F.viewport,...f(E,r,D)}}))},setDpr:l=>h(u=>{const y=nt(l);return{viewport:{...u.viewport,dpr:y,initialDpr:u.viewport.initialDpr||y}}}),setFrameloop:(l="always")=>{const u=a().clock;u.stop(),u.elapsedTime=0,l!=="never"&&(u.start(),u.elapsedTime=0),h(()=>({frameloop:l}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:P.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(l,u,y)=>{const S=a().internal;return S.priority=S.priority+(u>0?1:0),S.subscribers.push({ref:l,priority:u,store:y}),S.subscribers=S.subscribers.sort((j,E)=>j.priority-E.priority),()=>{const j=a().internal;j!=null&&j.subscribers&&(j.priority=j.priority-(u>0?1:0),j.subscribers=j.subscribers.filter(E=>E.ref!==l))}}}}}),i=n.getState();let s=i.size,c=i.viewport.dpr,w=i.camera;return n.subscribe(()=>{const{camera:h,size:a,viewport:g,gl:r,set:o}=n.getState();if(a!==s||g.dpr!==c){var f;s=a,c=g.dpr,tn(h,a),r.setPixelRatio(g.dpr);const d=(f=a.updateStyle)!=null?f:typeof HTMLCanvasElement<"u"&&r.domElement instanceof HTMLCanvasElement;r.setSize(a.width,a.height,d)}h!==w&&(w=h,o(d=>({viewport:{...d.viewport,...d.viewport.getCurrentViewport(h)}})))}),n.subscribe(h=>e(h)),n};function an(e,t){const n={callback:e};return t.add(n),()=>void t.delete(n)}let ve,at=new Set,ln=new Set,cn=new Set;const zn=e=>an(e,at);function _e(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function le(e,t){switch(e){case"before":return _e(at,t);case"after":return _e(ln,t);case"tail":return _e(cn,t)}}let Pe,Me;function Ce(e,t,n){let i=t.clock.getDelta();for(t.frameloop==="never"&&typeof e=="number"&&(i=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),Pe=t.internal.subscribers,ve=0;ve<Pe.length;ve++)Me=Pe[ve],Me.ref.current(Me.store.getState(),i,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}function un(e){let t=!1,n,i,s;function c(a){i=requestAnimationFrame(c),t=!0,n=0,le("before",a);for(const r of e.values()){var g;s=r.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((g=s.gl.xr)!=null&&g.isPresenting)&&(n+=Ce(a,s))}if(le("after",a),n===0)return le("tail",a),t=!1,cancelAnimationFrame(i)}function w(a,g=1){var r;if(!a)return e.forEach(o=>w(o.store.getState()),g);(r=a.gl.xr)!=null&&r.isPresenting||!a.internal.active||a.frameloop==="never"||(a.internal.frames=Math.min(60,a.internal.frames+g),t||(t=!0,requestAnimationFrame(c)))}function h(a,g=!0,r,o){if(g&&le("before",a),r)Ce(a,r,o);else for(const f of e.values())Ce(a,f.store.getState());g&&le("after",a)}return{loop:c,invalidate:w,advance:h}}function lt(){const e=P.useContext(st);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function fn(e=n=>n,t){return lt()(e,t)}function dn(e,t=0){const n=lt(),i=n.getState().internal.subscribe,s=Qe(e);return ue(()=>i(s,t,n),[t,i,n]),null}function ct(e,t){return function(n,...i){const s=new n;return e&&e(s),Promise.all(i.map(c=>new Promise((w,h)=>s.load(c,a=>{a.scene&&Object.assign(a,Qt(a.scene)),w(a)},t,a=>h(new Error(`Could not load ${c}: ${a.message})`))))))}}function ut(e,t,n,i){const s=Array.isArray(t)?t:[t],c=Ut(ct(n,i),[e,...s],{equal:L.equ});return Array.isArray(t)?c:c[0]}ut.preload=function(e,t,n){const i=Array.isArray(t)?t:[t];return Vt(ct(n),[e,...i])};ut.clear=function(e,t){const n=Array.isArray(t)?t:[t];return Gt([e,...n])};const ie=new Map,{invalidate:Be,advance:Ue}=un(ie),{reconciler:me,applyProps:ce}=Yt(ie,nn),te={objects:"shallow",strict:!1},pn=(e,t)=>{const n=typeof e=="function"?e(t):e;return it(n)?n:new xt({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function vn(e,t){if(t)return t;if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:n,height:i,top:s,left:c}=e.parentElement.getBoundingClientRect();return{width:n,height:i,top:s,left:c}}else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function mn(e){const t=ie.get(e),n=t==null?void 0:t.fiber,i=t==null?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,c=i||sn(Be,Ue),w=n||me.createContainer(c,oe.ConcurrentRoot,null,!1,null,"",s,null);t||ie.set(e,{fiber:w,store:c});let h,a=!1,g;return{configure(r={}){let{gl:o,size:f,scene:d,events:p,onCreated:M,shadows:v=!1,linear:l=!1,flat:u=!1,legacy:y=!1,orthographic:S=!1,frameloop:j="always",dpr:E=[1,2],performance:D,raycaster:F,camera:T,onPointerMissed:R}=r,b=c.getState(),k=b.gl;b.gl||b.set({gl:k=pn(o,e)});let $=b.raycaster;$||b.set({raycaster:$=new St});const{params:V,...H}=F||{};if(L.equ(H,$,te)||ce($,{...H}),L.equ(V,$.params,te)||ce($,{params:{...$.params,...V}}),!b.camera||b.camera===g&&!L.equ(g,T,te)){g=T;const O=T instanceof Ot,x=O?T:S?new Te(0,0,0,0,.1,1e3):new ke(75,0,.1,1e3);O||(x.position.z=5,T&&ce(x,T),!b.camera&&!(T!=null&&T.rotation)&&x.lookAt(0,0,0)),b.set({camera:x})}if(!b.scene){let O;d instanceof ze?O=d:(O=new ze,d&&ce(O,d)),b.set({scene:ne(O)})}if(!b.xr){const O=(A,U)=>{const N=c.getState();N.frameloop!=="never"&&Ue(A,!0,N,U)},x=()=>{const A=c.getState();A.gl.xr.enabled=A.gl.xr.isPresenting,A.gl.xr.setAnimationLoop(A.gl.xr.isPresenting?O:null),A.gl.xr.isPresenting||Be(A)},W={connect(){const A=c.getState().gl;A.xr.addEventListener("sessionstart",x),A.xr.addEventListener("sessionend",x)},disconnect(){const A=c.getState().gl;A.xr.removeEventListener("sessionstart",x),A.xr.removeEventListener("sessionend",x)}};k.xr&&W.connect(),b.set({xr:W})}if(k.shadowMap){const O=k.shadowMap.enabled,x=k.shadowMap.type;if(k.shadowMap.enabled=!!v,L.boo(v))k.shadowMap.type=ye;else if(L.str(v)){var B;const W={basic:jt,percentage:Tt,soft:ye,variance:kt};k.shadowMap.type=(B=W[v])!=null?B:ye}else L.obj(v)&&Object.assign(k.shadowMap,v);(O!==k.shadowMap.enabled||x!==k.shadowMap.type)&&(k.shadowMap.needsUpdate=!0)}const I=Ke();I&&("enabled"in I?I.enabled=!y:"legacyMode"in I&&(I.legacyMode=y));const m=l?Rt:Ve,C=u?At:Dt;k.outputEncoding!==m&&(k.outputEncoding=m),k.toneMapping!==C&&(k.toneMapping=C),b.legacy!==y&&b.set(()=>({legacy:y})),b.linear!==l&&b.set(()=>({linear:l})),b.flat!==u&&b.set(()=>({flat:u})),o&&!L.fun(o)&&!it(o)&&!L.equ(o,k,te)&&ce(k,o),p&&!b.events.handlers&&b.set({events:p(c)});const _=vn(e,f);return L.equ(_,b.size,te)||b.setSize(_.width,_.height,_.updateStyle,_.top,_.left),E&&b.viewport.dpr!==nt(E)&&b.setDpr(E),b.frameloop!==j&&b.setFrameloop(j),b.onPointerMissed||b.set({onPointerMissed:R}),D&&!L.equ(D,b.performance,te)&&b.set(O=>({performance:{...O.performance,...D}})),h=M,a=!0,this},render(r){return a||this.configure(),me.updateContainer(P.createElement(hn,{store:c,children:r,onCreated:h,rootElement:e}),w,null,()=>{}),c},unmount(){ft(e)}}}function hn({store:e,children:t,onCreated:n,rootElement:i}){return ue(()=>{const s=e.getState();s.set(c=>({internal:{...c.internal,active:!0}})),n&&n(s),e.getState().events.connected||s.events.connect==null||s.events.connect(i)},[]),P.createElement(st.Provider,{value:e},t)}function ft(e,t){const n=ie.get(e),i=n==null?void 0:n.fiber;if(i){const s=n==null?void 0:n.store.getState();s&&(s.internal.active=!1),me.updateContainer(null,i,null,()=>{s&&setTimeout(()=>{try{var c,w,h,a;s.events.disconnect==null||s.events.disconnect(),(c=s.gl)==null||(w=c.renderLists)==null||w.dispose==null||w.dispose(),(h=s.gl)==null||h.forceContextLoss==null||h.forceContextLoss(),(a=s.gl)!=null&&a.xr&&s.xr.disconnect(),en(s),ie.delete(e),t&&t(e)}catch{}},500)})}}me.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:P.version});const Ee={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function gn(e){const{handlePointer:t}=on(e);return{priority:1,enabled:!0,compute(n,i,s){i.pointer.set(n.offsetX/i.size.width*2-1,-(n.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(Ee).reduce((n,i)=>({...n,[i]:t(i)}),{}),update:()=>{var n;const{events:i,internal:s}=e.getState();(n=s.lastEvent)!=null&&n.current&&i.handlers&&i.handlers.onPointerMove(s.lastEvent.current)},connect:n=>{var i;const{set:s,events:c}=e.getState();c.disconnect==null||c.disconnect(),s(w=>({events:{...w.events,connected:n}})),Object.entries((i=c.handlers)!=null?i:[]).forEach(([w,h])=>{const[a,g]=Ee[w];n.addEventListener(a,h,{passive:g})})},disconnect:()=>{const{set:n,events:i}=e.getState();if(i.connected){var s;Object.entries((s=i.handlers)!=null?s:[]).forEach(([c,w])=>{if(i&&i.connected instanceof HTMLElement){const[h]=Ee[c];i.connected.removeEventListener(h,w)}}),n(c=>({events:{...c.events,connected:void 0}}))}}}}const yn=P.forwardRef(function({children:t,fallback:n,resize:i,style:s,gl:c,events:w=gn,eventSource:h,eventPrefix:a,shadows:g,linear:r,flat:o,legacy:f,orthographic:d,frameloop:p,dpr:M,performance:v,raycaster:l,camera:u,onPointerMissed:y,onCreated:S,...j},E){P.useMemo(()=>Xt(zt),[]);const D=$t(),[F,T]=Ht({scroll:!0,debounce:{scroll:50,resize:0},...i}),R=P.useRef(null),b=P.useRef(null);P.useImperativeHandle(E,()=>R.current);const k=Qe(y),[$,V]=P.useState(!1),[H,B]=P.useState(!1);if($)throw $;if(H)throw H;const I=P.useRef(null);ue(()=>{const C=R.current;T.width>0&&T.height>0&&C&&(I.current||(I.current=mn(C)),I.current.configure({gl:c,events:w,shadows:g,linear:r,flat:o,legacy:f,orthographic:d,frameloop:p,dpr:M,performance:v,raycaster:l,camera:u,size:T,onPointerMissed:(..._)=>k.current==null?void 0:k.current(..._),onCreated:_=>{_.events.connect==null||_.events.connect(h?Zt(h)?h.current:h:b.current),a&&_.setEvents({compute:(O,x)=>{const W=O[a+"X"],A=O[a+"Y"];x.pointer.set(W/x.size.width*2-1,-(A/x.size.height)*2+1),x.raycaster.setFromCamera(x.pointer,x.camera)}}),S==null||S(_)}}),I.current.render(P.createElement(D,null,P.createElement(et,{set:B},P.createElement(P.Suspense,{fallback:P.createElement(Kt,{set:V})},t)))))}),P.useEffect(()=>{const C=R.current;if(C)return()=>ft(C)},[]);const m=h?"none":"auto";return P.createElement("div",je({ref:b,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:m,...s}},j),P.createElement("div",{ref:F,style:{width:"100%",height:"100%"}},P.createElement("canvas",{ref:R,style:{display:"block"}},n)))}),Ln=P.forwardRef(function(t,n){return P.createElement(Wt,null,P.createElement(yn,je({},t,{ref:n})))}),fe=new Y,Ae=new Y,bn=new Y;function wn(e,t,n){const i=fe.setFromMatrixPosition(e.matrixWorld);i.project(t);const s=n.width/2,c=n.height/2;return[i.x*s+s,-(i.y*c)+c]}function _n(e,t){const n=fe.setFromMatrixPosition(e.matrixWorld),i=Ae.setFromMatrixPosition(t.matrixWorld),s=n.sub(i),c=t.getWorldDirection(bn);return s.angleTo(c)>Math.PI/2}function Pn(e,t,n,i){const s=fe.setFromMatrixPosition(e.matrixWorld),c=s.clone();c.project(t),n.setFromCamera(c,t);const w=n.intersectObjects(i,!0);if(w.length){const h=w[0].distance;return s.distanceTo(n.ray.origin)<h}return!0}function Mn(e,t){if(t instanceof Te)return t.zoom;if(t instanceof ke){const n=fe.setFromMatrixPosition(e.matrixWorld),i=Ae.setFromMatrixPosition(t.matrixWorld),s=t.fov*Math.PI/180,c=n.distanceTo(i);return 1/(2*Math.tan(s/2)*c)}else return 1}function Cn(e,t,n){if(t instanceof ke||t instanceof Te){const i=fe.setFromMatrixPosition(e.matrixWorld),s=Ae.setFromMatrixPosition(t.matrixWorld),c=i.distanceTo(s),w=(n[1]-n[0])/(t.far-t.near),h=n[1]-w*t.far;return Math.round(w*c+h)}}const Oe=e=>Math.abs(e)<1e-10?0:e;function dt(e,t,n=""){let i="matrix3d(";for(let s=0;s!==16;s++)i+=Oe(t[s]*e.elements[s])+(s!==15?",":")");return n+i}const En=(e=>t=>dt(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Sn=(e=>(t,n)=>dt(t,e(n),"translate(-50%,-50%)"))(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1]);function xn(e){return e&&typeof e=="object"&&"current"in e}const Hn=P.forwardRef(({children:e,eps:t=.001,style:n,className:i,prepend:s,center:c,fullscreen:w,portal:h,distanceFactor:a,sprite:g=!1,transform:r=!1,occlude:o,onOcclude:f,castShadow:d,receiveShadow:p,material:M,geometry:v,zIndexRange:l=[16777271,0],calculatePosition:u=wn,as:y="div",wrapperClass:S,pointerEvents:j="auto",...E},D)=>{const{gl:F,camera:T,scene:R,size:b,raycaster:k,events:$,viewport:V}=fn(),[H]=P.useState(()=>document.createElement(y)),B=P.useRef(),I=P.useRef(null),m=P.useRef(0),C=P.useRef([0,0]),_=P.useRef(null),O=P.useRef(null),x=(h==null?void 0:h.current)||$.connected||F.domElement.parentNode,W=P.useRef(null),A=P.useRef(!1),U=P.useMemo(()=>o&&o!=="blending"||Array.isArray(o)&&o.length&&xn(o[0]),[o]);P.useLayoutEffect(()=>{const q=F.domElement;o&&o==="blending"?(q.style.zIndex=`${Math.floor(l[0]/2)}`,q.style.position="absolute",q.style.pointerEvents="none"):(q.style.zIndex=null,q.style.position=null,q.style.pointerEvents=null)},[o]),P.useLayoutEffect(()=>{if(I.current){const q=B.current=qt(H);if(R.updateMatrixWorld(),r)H.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const z=u(I.current,T,b);H.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${z[0]}px,${z[1]}px,0);transform-origin:0 0;`}return x&&(s?x.prepend(H):x.appendChild(H)),()=>{x&&x.removeChild(H),q.unmount()}}},[x,r]),P.useLayoutEffect(()=>{S&&(H.className=S)},[S]);const N=P.useMemo(()=>r?{position:"absolute",top:0,left:0,width:b.width,height:b.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:c?"translate3d(-50%,-50%,0)":"none",...w&&{top:-b.height/2,left:-b.width/2,width:b.width,height:b.height},...n},[n,c,w,b,r]),Q=P.useMemo(()=>({position:"absolute",pointerEvents:j}),[j]);P.useLayoutEffect(()=>{if(A.current=!1,r){var q;(q=B.current)==null||q.render(P.createElement("div",{ref:_,style:N},P.createElement("div",{ref:O,style:Q},P.createElement("div",{ref:D,className:i,style:n,children:e}))))}else{var z;(z=B.current)==null||z.render(P.createElement("div",{ref:D,style:N,className:i,children:e}))}});const ee=P.useRef(!0);dn(q=>{if(I.current){T.updateMatrixWorld(),I.current.updateWorldMatrix(!0,!1);const z=r?C.current:u(I.current,T,b);if(r||Math.abs(m.current-T.zoom)>t||Math.abs(C.current[0]-z[0])>t||Math.abs(C.current[1]-z[1])>t){const Z=_n(I.current,T);let G=!1;U&&(Array.isArray(o)?G=o.map(K=>K.current):o!=="blending"&&(G=[R]));const se=ee.current;if(G){const K=Pn(I.current,T,k,G);ee.current=K&&!Z}else ee.current=!Z;se!==ee.current&&(f?f(!ee.current):H.style.display=ee.current?"block":"none");const de=Math.floor(l[0]/2),pt=o?U?[l[0],de]:[de-1,0]:l;if(H.style.zIndex=`${Cn(I.current,T,pt)}`,r){const[K,Fe]=[b.width/2,b.height/2],he=T.projectionMatrix.elements[5]*Fe,{isOrthographicCamera:Ie,top:vt,left:mt,bottom:ht,right:gt}=T,yt=En(T.matrixWorldInverse),bt=Ie?`scale(${he})translate(${Oe(-(gt+mt)/2)}px,${Oe((vt+ht)/2)}px)`:`translateZ(${he}px)`;let J=I.current.matrixWorld;g&&(J=T.matrixWorldInverse.clone().transpose().copyPosition(J).scale(I.current.scale),J.elements[3]=J.elements[7]=J.elements[11]=0,J.elements[15]=1),H.style.width=b.width+"px",H.style.height=b.height+"px",H.style.perspective=Ie?"":`${he}px`,_.current&&O.current&&(_.current.style.transform=`${bt}${yt}translate(${K}px,${Fe}px)`,O.current.style.transform=Sn(J,1/((a||10)/400)))}else{const K=a===void 0?1:Mn(I.current,T)*a;H.style.transform=`translate3d(${z[0]}px,${z[1]}px,0) scale(${K})`}C.current=z,m.current=T.zoom}}if(!U&&W.current&&!A.current)if(r){if(_.current){const z=_.current.children[0];if(z!=null&&z.clientWidth&&z!=null&&z.clientHeight){const{isOrthographicCamera:Z}=T;if(Z||v)E.scale&&(Array.isArray(E.scale)?E.scale instanceof Y?W.current.scale.copy(E.scale.clone().divideScalar(1)):W.current.scale.set(1/E.scale[0],1/E.scale[1],1/E.scale[2]):W.current.scale.setScalar(1/E.scale));else{const G=(a||10)/400,se=z.clientWidth*G,de=z.clientHeight*G;W.current.scale.set(se,de,1)}A.current=!0}}}else{const z=H.children[0];if(z!=null&&z.clientWidth&&z!=null&&z.clientHeight){const Z=1/V.factor,G=z.clientWidth*Z,se=z.clientHeight*Z;W.current.scale.set(G,se,1),A.current=!0}W.current.lookAt(q.camera.position)}});const De=P.useMemo(()=>({vertexShader:r?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom" 
            is false. 
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;
            
            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[r]);return P.createElement("group",je({},E,{ref:I}),o&&!U&&P.createElement("mesh",{castShadow:d,receiveShadow:p,ref:W},v||P.createElement("planeGeometry",null),M||P.createElement("shaderMaterial",{side:Lt,vertexShader:De.vertexShader,fragmentShader:De.fragmentShader})))});export{Ln as C,Hn as H,zn as a,ce as b,dn as c,fn as d,Xt as e,In as g,ut as u};
//# sourceMappingURL=vendor.@react-three-2c238abe.js.map
